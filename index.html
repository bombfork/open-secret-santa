<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Secret Santa</title>
    <!-- Runtime CSS loading: CDN for web, local for Capacitor -->
    <script>
        // Detect Capacitor environment and load appropriate CSS
        if (window.Capacitor) {
            // Running in Capacitor (mobile app) - load local CSS
            document.write('<link rel="stylesheet" href="assets/pico.min.css">');
        } else {
            // Running in browser (GitHub Pages) - load CDN CSS
            document.write('<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css">');
        }
    </script>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body>
    <main class="container">
        <!-- Landing Page -->
        <div id="landing-page" class="page">
            <div class="header-with-language">
                <hgroup>
                    <h1>üéÖ Secret Santa</h1>
                    <p>Organize your gift exchange with ease</p>
                </hgroup>
                <!-- Language Selector -->
                <div id="language-selector-container"></div>
            </div>

            <article>
                <header><strong>How it works</strong></header>
                <ol>
                    <li>Create a new Secret Santa with participant names</li>
                    <li>Set a random seed for reproducible assignments</li>
                    <li>Share individual links with each participant</li>
                    <li>Each person sees only who they're giving to</li>
                    <li>Admin can view all assignments with password</li>
                </ol>
            </article>

            <article class="security-notice">
                <header><strong>üéÑ Made for Fair Players</strong></header>
                <p>
                    This app works on the honor system! Links are encoded (not encrypted),
                    so it's best for trustworthy groups like family, friends, or coworkers.
                    If you need Fort Knox security, this might not be your app! üòä
                </p>
            </article>

            <div class="grid">
                <button id="create-btn" class="contrast">Create New Secret Santa</button>
                <button id="view-btn" class="secondary">View Your Assignment</button>
            </div>
        </div>

        <!-- Create Mode -->
        <div id="create-page" class="page hidden">
            <h1>Create Secret Santa</h1>

            <form id="create-form">
                <label for="participants">
                    Participant Names
                    <small>Enter one name per line (minimum 3 participants)</small>
                    <textarea id="participants" rows="8" placeholder="Alice&#10;Bob&#10;Charlie&#10;Diana" required></textarea>
                </label>

                <label for="seed">
                    Random Seed
                    <small>Use the same seed to get the same assignments</small>
                    <input type="text" id="seed" placeholder="e.g., christmas2024" required>
                </label>

                <label for="admin-password">
                    Admin Password
                    <small>Optional - leave blank for no password protection</small>
                    <input type="password" id="admin-password" placeholder="Enter admin password (optional)">
                </label>

                <div class="grid">
                    <button type="button" id="back-to-landing" class="secondary">Back</button>
                    <button type="submit">Generate Secret Santa</button>
                </div>
            </form>
        </div>

        <!-- Results Page -->
        <div id="results-page" class="page hidden">
            <h1>Secret Santa Created!</h1>

            <article>
                <header><strong>Admin Link</strong></header>
                <p><small>Share this with the organizer to view all assignments</small></p>
                <div class="link-container">
                    <input type="text" id="admin-link" readonly>
                    <div class="button-group">
                        <button class="copy-btn" data-target="admin-link">Copy</button>
                        <button class="share-btn secondary" id="share-admin-btn"></button>
                    </div>
                </div>
            </article>

            <article>
                <header><strong>Participant Links</strong></header>
                <p><small>Share each link with the corresponding participant</small></p>
                <div id="participant-links"></div>
            </article>

            <button id="create-another" class="secondary">Create Another</button>
        </div>

        <!-- View Mode (Participant) -->
        <div id="view-participant-page" class="page hidden">
            <h1>Your Secret Santa Assignment</h1>

            <article class="assignment-card">
                <header>
                    <strong id="participant-name"></strong>
                </header>
                <p>You are Secret Santa for:</p>
                <h2 id="assigned-to"></h2>
                <footer>
                    <small>ü§´ Keep it secret!</small>
                </footer>
            </article>

            <button id="back-from-view">Back to Home</button>
        </div>

        <!-- View Mode (Admin) -->
        <div id="view-admin-page" class="page hidden">
            <h1>Admin View</h1>

            <!-- Participant Links Section (always visible) -->
            <article>
                <header><strong>Participant Links</strong></header>
                <p><small>Share these links with participants if they need them again</small></p>
                <div id="admin-participant-links"></div>
            </article>

            <!-- Password Section -->
            <article>
                <label for="admin-password-input">
                    Enter Admin Password
                    <input type="password" id="admin-password-input" placeholder="Admin password">
                </label>
                <button id="unlock-admin">View All Assignments</button>
            </article>

            <!-- Assignments Table (hidden until unlocked) -->
            <div id="all-assignments" class="hidden">
                <article>
                    <header><strong>All Secret Santa Assignments</strong></header>
                    <table>
                        <thead>
                            <tr>
                                <th>Giver</th>
                                <th>‚Üí</th>
                                <th>Receiver</th>
                            </tr>
                        </thead>
                        <tbody id="assignments-table"></tbody>
                    </table>
                </article>
            </div>

            <button id="back-from-admin">Back to Home</button>
        </div>

        <!-- Error Page -->
        <div id="error-page" class="page hidden">
            <article>
                <header><strong>‚ö†Ô∏è Error</strong></header>
                <p id="error-message"></p>
                <button id="back-from-error">Back to Home</button>
            </article>
        </div>
    </main>

    <script type="module" src="js/main.js"></script>
</body>
</html>
